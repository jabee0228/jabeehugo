<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Diffusion Model on Jabee&#39;s Blog</title>
    <link>https://jabeehugo.netlify.app/tags/diffusion-model/</link>
    <description>Recent content in Diffusion Model on Jabee&#39;s Blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-tw</language>
    <lastBuildDate>Thu, 26 Dec 2024 11:41:33 +0800</lastBuildDate><atom:link href="https://jabeehugo.netlify.app/tags/diffusion-model/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>DDPM paper notes</title>
      <link>https://jabeehugo.netlify.app/notes/241226/</link>
      <pubDate>Thu, 26 Dec 2024 11:41:33 +0800</pubDate>
      
      <guid>https://jabeehugo.netlify.app/notes/241226/</guid>
      <description>&lt;p&gt;é€™ç¯‡ä¸»è¦æ˜¯åƒè€ƒææ•™æˆçš„å½±ç‰‡ï¼Œä»¥åŠç¶²è·¯ä¸Šçš„æ–‡ç« ï¼Œæ•´ç†çš„ç­†è¨˜ã€‚&lt;/p&gt;
&lt;h1 id=&#34;algorithm-1-training&#34;&gt;Algorithm 1: Training&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;ç¬¬-1-è¡Œrepeat&#34;&gt;&lt;strong&gt;ç¬¬ 1 è¡Œï¼š&lt;code&gt;repeat&lt;/code&gt;&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨ï¼š&lt;/strong&gt; é–‹å§‹ä¸€å€‹è¿­ä»£è¨“ç·´éç¨‹ï¼Œç›´åˆ°æ¨¡å‹æ”¶æ–‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç¬¬-2-è¡Œ&#34;&gt;&lt;strong&gt;ç¬¬ 2 è¡Œ&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨ï¼š&lt;/strong&gt; å¾æ•¸æ“šåˆ†ä½ˆ ä¸­å–ä¸€å€‹æ¨£æœ¬ (x0)ï¼ˆå³å¾è¨“ç·´æ•¸æ“šé›†ä¸­æŠ½å–ä¸€å€‹æ•¸æ“šé»ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;x0 ä»£è¡¨ clean Image&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;q(x0)ï¼š&lt;/strong&gt; æ•¸æ“šåˆ†ä½ˆï¼Œå³è¨“ç·´é›†ä¸­æ•¸æ“šçš„çœŸå¯¦åˆ†ä½ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç¬¬-3-è¡Œ&#34;&gt;&lt;strong&gt;ç¬¬ 3 è¡Œ&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨ï¼š&lt;/strong&gt; éš¨æ©Ÿé¸æ“‡ä¸€å€‹æ™‚é–“tã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç¬¬-4-è¡Œ&#34;&gt;&lt;strong&gt;ç¬¬ 4 è¡Œ&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨ï¼š&lt;/strong&gt; å–ä¸€å€‹éš¨æ©Ÿå™ªè²æ¨£æœ¬ ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§£é‡‹ï¼š&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ“´æ•£éç¨‹ä¸­ï¼Œæ•¸æ“šæœƒé€æ­¥è¢«åŠ ä¸Šå™ªè²ï¼Œæœ€çµ‚è®Šæˆå®Œå…¨éš¨æ©Ÿçš„é«˜æ–¯å™ªè²ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨è¨“ç·´éç¨‹ä¸­ï¼Œéœ€è¦ç”¨éš¨æ©Ÿå™ªè²æ¨¡æ“¬é€™å€‹æ“´æ•£éç¨‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç¬¬-5-è¡Œæ¢¯åº¦ä¸‹é™æ›´æ–°&#34;&gt;&lt;strong&gt;ç¬¬ 5 è¡Œï¼šæ¢¯åº¦ä¸‹é™æ›´æ–°&lt;/strong&gt;&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;âˆ‡_Î¸ â€–Îµ âˆ’ Îµ_Î¸(âˆšÎ±Ì„_t x_0 + âˆš(1âˆ’Î±Ì„_t) Îµ, t)â€–Â²
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç´°ç¯€è§£é‡‹ï¼š&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Îµ ç‚ºåŸå§‹å™ªè²&lt;/p&gt;</description>
      <content:encoded>&lt;p&gt;é€™ç¯‡ä¸»è¦æ˜¯åƒè€ƒææ•™æˆçš„å½±ç‰‡ï¼Œä»¥åŠç¶²è·¯ä¸Šçš„æ–‡ç« ï¼Œæ•´ç†çš„ç­†è¨˜ã€‚&lt;/p&gt;
&lt;h1 id=&#34;algorithm-1-training&#34;&gt;Algorithm 1: Training&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;ç¬¬-1-è¡Œrepeat&#34;&gt;&lt;strong&gt;ç¬¬ 1 è¡Œï¼š&lt;code&gt;repeat&lt;/code&gt;&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨ï¼š&lt;/strong&gt; é–‹å§‹ä¸€å€‹è¿­ä»£è¨“ç·´éç¨‹ï¼Œç›´åˆ°æ¨¡å‹æ”¶æ–‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç¬¬-2-è¡Œ&#34;&gt;&lt;strong&gt;ç¬¬ 2 è¡Œ&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨ï¼š&lt;/strong&gt; å¾æ•¸æ“šåˆ†ä½ˆ ä¸­å–ä¸€å€‹æ¨£æœ¬ (x0)ï¼ˆå³å¾è¨“ç·´æ•¸æ“šé›†ä¸­æŠ½å–ä¸€å€‹æ•¸æ“šé»ï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;x0 ä»£è¡¨ clean Image&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;q(x0)ï¼š&lt;/strong&gt; æ•¸æ“šåˆ†ä½ˆï¼Œå³è¨“ç·´é›†ä¸­æ•¸æ“šçš„çœŸå¯¦åˆ†ä½ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç¬¬-3-è¡Œ&#34;&gt;&lt;strong&gt;ç¬¬ 3 è¡Œ&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨ï¼š&lt;/strong&gt; éš¨æ©Ÿé¸æ“‡ä¸€å€‹æ™‚é–“tã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç¬¬-4-è¡Œ&#34;&gt;&lt;strong&gt;ç¬¬ 4 è¡Œ&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨ï¼š&lt;/strong&gt; å–ä¸€å€‹éš¨æ©Ÿå™ªè²æ¨£æœ¬ ã€‚
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§£é‡‹ï¼š&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;æ“´æ•£éç¨‹ä¸­ï¼Œæ•¸æ“šæœƒé€æ­¥è¢«åŠ ä¸Šå™ªè²ï¼Œæœ€çµ‚è®Šæˆå®Œå…¨éš¨æ©Ÿçš„é«˜æ–¯å™ªè²ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨è¨“ç·´éç¨‹ä¸­ï¼Œéœ€è¦ç”¨éš¨æ©Ÿå™ªè²æ¨¡æ“¬é€™å€‹æ“´æ•£éç¨‹ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç¬¬-5-è¡Œæ¢¯åº¦ä¸‹é™æ›´æ–°&#34;&gt;&lt;strong&gt;ç¬¬ 5 è¡Œï¼šæ¢¯åº¦ä¸‹é™æ›´æ–°&lt;/strong&gt;&lt;/h3&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;âˆ‡_Î¸ â€–Îµ âˆ’ Îµ_Î¸(âˆšÎ±Ì„_t x_0 + âˆš(1âˆ’Î±Ì„_t) Îµ, t)â€–Â²
&lt;/code&gt;&lt;/pre&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç´°ç¯€è§£é‡‹ï¼š&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Îµ ç‚ºåŸå§‹å™ªè²&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Îµ_Î¸(âˆšÎ±Ì„_t x_0 + âˆš(1âˆ’Î±Ì„_t) Îµ, t) é€™ä¸€æ®µåšçš„å‰‡æ˜¯ noise predictorã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è€Œ noise predictor æœƒæœ‰ä»¥ä¸‹å…©å€‹ input&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;input 1. âˆšÎ±Ì„_t x_0 + âˆš(1âˆ’Î±Ì„_t) Îµ ; input 2. t ä»£è¡¨ç¬¬å¹¾å€‹å›åˆçš„ å›åˆè¶Šå¾Œé¢ï¼ŒåŠ ä¸Šçš„å™ªè²è¶Šå¤šã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image1.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;âˆšÎ±Ì„_t x_0 + âˆš(1âˆ’Î±Ì„_t) Îµ ï¼šé€™é‚Š Î±Ì„_t æ˜¯æ ¹æ“š Unuiform å‡ºä¾†çš„ t ï¼Œå¦‚æœ t å€¼è¶Šå¤§ï¼ŒÎ±Ì„_t è¶Šå°ã€‚ Î±Ì„_t è¶Šå°ï¼Œä»£è¡¨åŠ ä¸Šçš„å™ªè²æ¯”ä¾‹å‰‡è¶Šå¤šï¼ˆå³é‚Šä¹˜ä¸Šçš„âˆš(1âˆ’Î±Ì„_t)ï¼‰ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;ç›®æ¨™ï¼š&lt;/strong&gt; æœ€å°åŒ– ï¼Œå³è®“æ¨¡å‹è¼¸å‡ºçš„å™ªè²èˆ‡å¯¦éš›åŠ å…¥çš„å™ªè²è¶Šæ¥è¿‘è¶Šå¥½ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;æ¢¯åº¦ä¸‹é™ï¼š&lt;/strong&gt; å°æ¨¡å‹çš„æå¤±å‡½æ•¸é€²è¡Œæ¢¯åº¦ä¸‹é™ï¼Œæ›´æ–°åƒæ•¸ ã€‚åˆ©ç”¨ MSE å¹³å‡å¹³æ–¹å·®æå¤±å»ç®— æ¢¯åº¦ä¸‹é™ç‡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç¬¬-6-è¡Œuntil-converged&#34;&gt;&lt;strong&gt;ç¬¬ 6 è¡Œï¼š&lt;code&gt;until converged&lt;/code&gt;&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä½œç”¨ï¼š&lt;/strong&gt; æŒçºŒè¿­ä»£ï¼Œç›´åˆ°æ¨¡å‹è¨“ç·´æ”¶æ–‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h1 id=&#34;algorithm-2-sampling&#34;&gt;Algorithm 2: Sampling&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image2.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;h3 id=&#34;ç¬¬ä¸€è¡Œ-çµ¦è¨‚ä¸€å€‹-x-å¤§-t-ç´”é›œè¨Šåœ–&#34;&gt;&lt;strong&gt;ç¬¬ä¸€è¡Œ çµ¦è¨‚ä¸€å€‹ X å¤§ T ç´”é›œè¨Šåœ–&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ„ç¾©&lt;/strong&gt;ï¼šå¾æ¨™æº–é«˜æ–¯åˆ†ä½ˆï¼ˆå‡å€¼ç‚º 0ï¼Œæ–¹å·®ç‚º 1ï¼‰ä¸­éš¨æ©Ÿç”Ÿæˆä¸€å€‹å™ªè²æ¨£æœ¬ä½œç‚ºèµ·å§‹é»ã€‚&lt;/li&gt;
&lt;li&gt;X å¤§ T ä»£è¡¨çš„æ˜¯ &lt;strong&gt;ç´”é›œè¨Šåœ–&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç¬¬äºŒè¡Œ-è¿´åœˆé–‹å§‹&#34;&gt;&lt;strong&gt;ç¬¬äºŒè¡Œ è¿´åœˆé–‹å§‹&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;å¾ç´”å™ªè²ä¸€è·¯ Sampling åˆ° ç”Ÿæˆåœ–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ„ç¾©&lt;/strong&gt;ï¼šå¾æ™‚é–“tï¼ˆæœ€ç´”çš„å™ªè²ï¼‰é–‹å§‹ï¼Œé€æ­¥å›æº¯åˆ° ï¼ˆé€æ¼¸å»å™ªç›´åˆ°é‚„åŸå‡ºæ¸…æ™°çš„æ•¸æ“šï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç¬¬ä¸‰è¡Œ-å™ªè²æ¢ä»¶&#34;&gt;&lt;strong&gt;ç¬¬ä¸‰è¡Œ å™ªè²æ¢ä»¶&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ„ç¾©&lt;/strong&gt;ï¼šåœ¨ Sampling éšæ®µï¼Œæœƒåœ¨åšå®Œæ¸›å» Noise predictor å¾Œï¼Œå†åŠ ä¸Š z å™ªè²ï¼ˆè«‹çœ‹ç¬¬å››è¡Œï¼‰
&lt;ul&gt;
&lt;li&gt;ä½†åœ¨ t == 0 æ™‚ï¼Œå·²ç¶“å®Œæˆ Sampling ï¼Œå› æ­¤ä¸å†åŠ ä¸Š z ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç¬¬å››è¡Œ&#34;&gt;&lt;strong&gt;ç¬¬å››è¡Œ&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image3.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;x_{t-1} = (1 / âˆš(a_t)) * (x_t - (1 - a_t) / âˆš(1 - Î±Ì„_t) * ÏµÎ¸(x_t, t)) + Ïƒ_t * z&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è©³è¦‹ï¼šSampling éšæ®µ Denoise function åŒ–ç°¡&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;åˆ†è§£ç†è§£&lt;/strong&gt;ï¼š
&lt;ol&gt;
&lt;li&gt;ÏµÎ¸(x_t, t)ï¼šNoise predicotr æ ¹æ“šç•¶å‰ t (å“ªä¸€éšæ®µ) ç”Ÿæˆå™ªè²&lt;/li&gt;
&lt;li&gt;(x_t - (1 - a_t) / âˆš(1 - Î±Ì„_t) * ÏµÎ¸(x_t, t)ï¼šå¾ç•¶å‰æ•¸æ“šä¸­æ¸›å»é æ¸¬çš„å™ªè²éƒ¨åˆ†ã€‚
&lt;ol&gt;
&lt;li&gt;x_t ä»£è¡¨çš„å‰‡æ˜¯ä¸Šä¸€éšæ®µçš„çµæœï¼Œå› æ­¤ = å³é‚Šæ˜¯x_{t-1} ï¼Œä¹Ÿå°±æ˜¯é€æ­¥ Sample åˆ° x0 ï¼ˆclean imageï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;(1 / âˆš(a_t))ï¼šï¼ˆä¹˜è™Ÿå·¦é‚Šï¼‰èª¿æ•´ä¿¡è™Ÿå¹…åº¦ï¼Œä½¿å…¶å›åˆ°æ­£ç¢ºçš„åˆ†ä½ˆç¯„åœã€‚&lt;/li&gt;
&lt;li&gt;
&lt;ul&gt;
&lt;li&gt;Ïƒ_t * zï¼šæ·»åŠ éš¨æ©Ÿå™ªè² ï¼Œ&lt;strong&gt;æ¨¡æ“¬åå‘éç¨‹çš„éš¨æ©Ÿæ€§&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç›®çš„&lt;/strong&gt;ï¼šå¾ç•¶å‰çš„té‚„åŸåˆ°ä¸Šä¸€å€‹t ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image4.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç¬¬äº”è¡Œ-è¿´åœˆçµæŸ&#34;&gt;&lt;strong&gt;ç¬¬äº”è¡Œ è¿´åœˆçµæŸ&lt;/strong&gt;&lt;/h3&gt;
&lt;hr&gt;
&lt;h3 id=&#34;ç¬¬å…­è¡Œ-æœ€çµ‚è¼¸å‡º&#34;&gt;&lt;strong&gt;ç¬¬å…­è¡Œ æœ€çµ‚è¼¸å‡º&lt;/strong&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ„ç¾©&lt;/strong&gt;ï¼šç•¶è¿´åœˆçµæŸæ™‚ï¼Œè¼¸å‡ºæœ€å¾Œçš„çµæœ ï¼Œé€™å°±æ˜¯é‚„åŸå‡ºçš„æ¸…æ™°æ•¸æ“šï¼ˆå¦‚åœ–åƒï¼‰ã€‚
&lt;ul&gt;
&lt;li&gt;x0 ä»£è¡¨ clean imageï¼Œå› æ­¤ return x0ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h1 id=&#34;maximum-likelihood-estimation&#34;&gt;Maximum Likelihood Estimation&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image5.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;MLE çš„ç›®çš„æ˜¯ç‚ºäº†è®“ PÎ¸ ç›¡å¯èƒ½çš„æ¥è¿‘æ–¼ Pdataã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PÎ¸(x)ï¼šmodel æ‰€ sample å‡ºçš„ distribution æ©Ÿç‡ã€‚&lt;/li&gt;
&lt;li&gt;Pdata(x) : çœŸå¯¦ä¸–ç•Œçš„ datasetï¼Œå’Œ model çš„ network ç„¡é—œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image6.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;å°‡æ¯ä¸€å€‹ sample å‡ºä¾†çš„ xi æ‹¿ pÎ¸ ç®—å‡ºæ©Ÿç‡ ä¸¦ç›¸ä¹˜ï¼Œç«Ÿå¯èƒ½æ‰¾å‡ºæœ€å¤§ Î¸ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘å€‘è¦æ‰¾çš„ Î¸ å°±æ˜¯æ©Ÿç‡æœ€é«˜çš„é‚£ä¸€å€‹ï¼ˆLHY åœ¨æŠ•å½±ç‰‡ç”¨ Î¸* ä»£è¡¨ï¼‰ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;network çš„ç›®æ¨™æ˜¯å­¸ç¿’æ•¸æ“šçš„è¦å¾‹ï¼ˆçœŸå¯¦åˆ†ä½ˆğ‘(ğ‘¥0)q(x0)ï¼‰ï¼Œç„¶å¾Œæ¨¡æ“¬é€™äº›æ•¸æ“šçš„æ©Ÿç‡ï¼Œé€™å°±æ˜¯ğ‘ğœƒ(ğ‘¥0)pÎ¸(x0)ã€‚å®ƒä»£è¡¨æ¨¡å‹èªç‚ºæ•¸æ“šğ‘¥0x0æœ‰å¤šã€Œåˆç†ã€æˆ–ã€Œå¯èƒ½ã€ã€‚
*from chatgpt&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image7.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;å¾log ç›¸ä¹˜è½‰æ›æˆ ç›¸åŠ log ï¼Œç›¸åŠ  log é€™æ¨£æœƒè¿‘ä¼¼æ–¼ å¾ pdata å–å‡ºçš„ x ï¼Œç„¶å¾Œ pÎ¸ ç®—å‡ºæ©Ÿç‡ è¦è¶Šå¤§è¶Šå¥½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image8.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;æ¥è‘—å¾ expectation è½‰æ›ç‚ºç©åˆ†ï¼Œç„¶å¾Œå¯ä»¥ç®—å‡ºå°±ç­‰åŒæ–¼ KL(Pdata||PÎ¸) ï¼Œæ‰€ä»¥æˆ‘å€‘è¦æ‰¾ minimun KLã€‚&lt;/p&gt;
&lt;p&gt;è®“ ptheta è®“ pdataçš„å·®ç•°æœ€å°ã€‚&lt;/p&gt;
&lt;h1 id=&#34;vae-compute-pÎ¸&#34;&gt;VAE: Compute pÎ¸&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image9.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;é€™é‚Šä¸»è¦æ˜¯åœ¨è¬›èªªï¼Œå› ç‚ºæˆ‘å€‘ä¸å¯èƒ½å»ç›´æ¥çœ‹ pÎ¸(x|z) ï¼Œå› ç‚ºä¸å¯èƒ½ sample å‡ºå®Œå…¨ä¸€æ¨¡ä¸€æ¨£çš„åœ–ï¼Œé€™æ¨£æœƒé€ æˆ pÎ¸(x|z) = 0ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤æˆ‘å€‘æ˜¯å»çœ‹ Mean of Gaussian (å»çœ‹è·é›¢ï¼Œä¹Ÿå°±æ˜¯ x å’Œ G(z)çš„è·é›¢)ã€‚&lt;/p&gt;
&lt;h1 id=&#34;vae-lower-bound-of&#34;&gt;VAE: Lower bound of&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image10.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;â‰¥ 0 æ˜¯å› ç‚º å®ƒå¯ä»¥çœ‹ä½œ KL divergence è€Œå®Œå…¨ä¸€æ¨£å°±ç‚º0ï¼Œå› æ­¤ â‰¥ 0ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;ddpm-compute--pÎ¸x&#34;&gt;DDPM: Compute  pÎ¸(x)&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image11.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image12.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ç®— DDPM æ™‚ï¼Œå’Œ VAE ä¸åŒçš„æ˜¯ï¼Œ Maximize æœŸæœ›å€¼æ™‚ï¼ŒåŸå…ˆçš„ Encoder æ›¿æ›æˆ Diffusion Processï¼Œä¹Ÿå°±æ˜¯åœ¨åŠ  Noise çš„é‚£å€‹éšæ®µã€‚&lt;/p&gt;
&lt;p&gt;å°‡å¼å­å±•é–‹å¾Œç‚ºä»¥ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image13.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;å¾ x1 ä¸€ç›´åšåˆ° X å¤§ T&lt;/p&gt;
&lt;h1 id=&#34;å–®å€‹-qxt--xt-1-ç®—æ³•&#34;&gt;å–®å€‹ q(XT | XT-1) ç®—æ³•&lt;/h1&gt;
&lt;p&gt;æˆ‘å€‘é¦–å…ˆè¦å…ˆå®šç¾©ä¸€çµ„ &lt;strong&gt;Î²1 ~ Î²T&lt;/strong&gt; ï¼Œé€™çµ„æ•¸å€¼ç‚ºè‡ªå®šç¾©çš„ï¼Œé¡ä¼¼ Learning rateï¼Œæœƒæ ¹æ“šä¿®æ”¹å½±éŸ¿ Networkã€‚ å› ç‚ºé€™æœƒå½±éŸ¿åœ¨æ¯ä¸€ t åŠ ä¸Šçš„å™ªè²&lt;/p&gt;
&lt;p&gt;ï¼ˆä»¥ä¸‹ææ•™æˆæœ‰ç­†èª¤ï¼Œæ‡‰ç‚º Xt = âˆš1-Bt * Xt-1 + âˆšBt * noiseï¼‰&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image14.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;h1 id=&#34;å¦‚æœè¦ç®—å‡º-qxt--x0&#34;&gt;å¦‚æœè¦ç®—å‡º q(XT | X0)&lt;/h1&gt;
&lt;p&gt;å…¶å¯¦æ˜¯å¯ä»¥ä¸ç”¨ä¸€æ¬¡ä¸€æ¬¡å»æŠŠå®ƒç®—å‡ºä¾†ï¼ˆä¸ç”¨ä¸€æ­¥ä¸€æ­¥æŠŠå®ƒ+ä¸Šå™ªè²ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¾ä¸‹æ–¹å¯ä»¥æ¨å°å‡º q(X2 | X0)&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image15.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image16.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image17.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image18.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;å› æ­¤ q(Xt | X0) å°±å¯ä»¥æ•´ç†æˆä¸Šåœ–ã€‚&lt;/p&gt;
&lt;h1 id=&#34;å™ªè²é æ¸¬&#34;&gt;å™ªè²é æ¸¬&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image19.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;å¾ä¸Šåœ–æ¨å°è‡³ä¸‹åœ–&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image20.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;ç›®æ¨™å°±æ˜¯å»æœ€å¤§åŒ–ï¼Œè€Œç‚ºäº†æœ€å¤§åŒ–ï¼Œä¹Ÿå°±æ˜¯ç›¡å¯èƒ½åœ°å°‡ KL Divergence æœ€å°åŒ–ã€‚ï¼ˆçœ‹å¾Œé¢çš„ï¼šKL Divergence between å‘å‰ and å‘å¾Œï¼‰&lt;/p&gt;
&lt;p&gt;ç®—å‡º KL Divergence å‘å‰ ğ‘ ( ğ‘¥ ğ‘¡ âˆ£ ğ‘¥ ğ‘¡ âˆ’ 1 ) q(x t  âˆ£x tâˆ’1  ) èˆ‡å‘å¾Œ ğ‘ƒ ğœƒ ( ğ‘¥ ğ‘¡ âˆ£ ğ‘¥ ğ‘¡ âˆ’ 1 ) P Î¸  (x t  âˆ£x tâˆ’1  ) çš„å·®ç•°ã€‚&lt;/p&gt;
&lt;p&gt;$\sum_{t=2}^T E_{q\left(x_t \mid x_0\right)}\left[D_{K L}\left(q\left(x_{t-1} \mid x_t, x_0\right)|| p_\theta\left(x_{t-1} \mid x_t\right)\right]\right.$&lt;/p&gt;
&lt;h2 id=&#34;ç®—å‡ºä¸­é–“xt-1åˆ°xtçš„åˆ†ä½ˆ-qxt-1--xt-x0&#34;&gt;ç®—å‡ºä¸­é–“xt-1åˆ°xtçš„åˆ†ä½ˆ q(Xt-1 | Xt, X0)&lt;/h2&gt;
&lt;p&gt;å‰é¢æˆ‘å€‘å·²ç¶“è¬›éäº†ï¼Œå¦‚ä½•ç®—å‡ºå¾ X0 åˆ° Xtï¼Œä¹ŸçŸ¥é“è¦å¦‚ä½•ç®—å‡º xt-1 åˆ° xt-1 çš„åˆ†ä½ˆã€‚&lt;/p&gt;
&lt;p&gt;æ¨å€’å…¬å¼å¦‚ä¸‹&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image21.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image22.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;h2 id=&#34;kl-divergence-between-å‘å‰-and-å‘å¾Œ&#34;&gt;KL Divergence between å‘å‰ and å‘å¾Œ&lt;/h2&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image23.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;å› ç‚ºå‘å‰çš„ Mean æ˜¯ä¸å¯å‹•çš„ï¼Œæ‰€ä»¥æˆ‘å€‘å”¯ä¸€å¯å‹•çš„å°±æ˜¯ P(Xt-1|Xt) çš„ Mean ï¼Œä½¿å…©è€…é›¢ä¸­å¿ƒé»çš„è·é›¢æœ€å°ï¼Œé€™æ¨£ä¸€ä¾†ï¼Œå°±å¯ä»¥ä½¿å¾— KL Divergence ç›¡å¯èƒ½çš„å°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image24.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥èªªä»¥ä¸Šåœ¨åšçš„äº‹æƒ…ä¹Ÿå°±æ˜¯è¨“ç·´ denoise function ï¼Œä½¿å¾—å®ƒå€‘å…©è€…è¶Šç›¸è¿‘è¶Šå¥½ã€‚&lt;/p&gt;
&lt;h1 id=&#34;sampling-éšæ®µ-denoise-function-åŒ–ç°¡&#34;&gt;Sampling éšæ®µ Denoise function åŒ–ç°¡&lt;/h1&gt;
&lt;p&gt;&lt;img loading=&#34;lazy&#34; src=&#34;https://jabeehugo.netlify.app/notes/241226/DDPM/image25.png&#34; type=&#34;&#34; alt=&#34;image.png&#34;  /&gt;&lt;/p&gt;
&lt;p&gt;åŸå…ˆå³ä¸Šè§’çš„å¼å­çš„ x0 å¯ä»¥æ ¹æ“šæˆ‘å€‘ä¸Šé¢å·²ç¶“å¯«å¥½é—œæ–¼ x0 å’Œ xt çš„é—œä¿‚ï¼Œåœ¨å¸¶å›å»åŒ–ç°¡ã€‚&lt;/p&gt;
&lt;p&gt;è€Œé€™é‚Šä¹Ÿå°±å›åˆ° Algorithm Sampling éšæ®µçš„ç¬¬å››è¡Œã€‚&lt;/p&gt;
&lt;h3 id=&#34;ref&#34;&gt;Ref&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.cvmart.net/community/detail/7942&#34;&gt;æ·±å…¥æµ…å‡ºæ‰©æ•£æ¨¡å‹(Diffusion Model)ç³»åˆ—ï¼šåŸºçŸ³DDPMï¼ˆäººäººéƒ½èƒ½çœ‹æ‡‚çš„æ•°å­¦åŸç†ç¯‡ï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://youtube.com/playlist?list=PLJV_el3uVTsNi7PgekEUFsyVllAJXRsP-&amp;amp;si=_y39Uu28junvh9re&#34;&gt;æå¼˜æ¯… DDPM&lt;/a&gt;&lt;/p&gt;
</content:encoded>
    </item>
    
  </channel>
</rss>
